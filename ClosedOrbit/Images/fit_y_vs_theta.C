void fit_y_vs_theta()
{
//=========Macro generated from canvas: c/c
//=========  (Thu Dec  3 10:36:09 2020) by ROOT version 6.12/04
   TCanvas *c = new TCanvas("c", "c",0,0,800,600);
   gStyle->SetOptFit(1);
   c->SetHighLightColor(2);
   c->Range(-0.7873502,-0.000419288,7.086151,0.000388894);
   c->SetFillColor(0);
   c->SetBorderMode(0);
   c->SetBorderSize(2);
   c->SetFrameBorderMode(0);
   c->SetFrameBorderMode(0);
   
   Double_t Graph0_fx2[360] = {
   0,
   0.01745329,
   0.03490658,
   0.05235988,
   0.06981317,
   0.08726646,
   0.1047198,
   0.122173,
   0.1396263,
   0.1570796,
   0.1745329,
   0.1919862,
   0.2094395,
   0.2268928,
   0.2443461,
   0.2617994,
   0.2792527,
   0.296706,
   0.3141593,
   0.3316126,
   0.3490658,
   0.3665192,
   0.3839724,
   0.4014257,
   0.418879,
   0.4363323,
   0.4537856,
   0.4712389,
   0.4886922,
   0.5061455,
   0.5235988,
   0.541052,
   0.5585054,
   0.5759587,
   0.5934119,
   0.6108652,
   0.6283185,
   0.6457718,
   0.6632251,
   0.6806784,
   0.6981317,
   0.715585,
   0.7330383,
   0.7504916,
   0.7679449,
   0.7853982,
   0.8028514,
   0.8203048,
   0.8377581,
   0.8552113,
   0.8726646,
   0.8901179,
   0.9075712,
   0.9250245,
   0.9424778,
   0.9599311,
   0.9773844,
   0.9948377,
   1.012291,
   1.029744,
   1.047198,
   1.064651,
   1.082104,
   1.099557,
   1.117011,
   1.134464,
   1.151917,
   1.169371,
   1.186824,
   1.204277,
   1.22173,
   1.239184,
   1.256637,
   1.27409,
   1.291544,
   1.308997,
   1.32645,
   1.343904,
   1.361357,
   1.37881,
   1.396263,
   1.413717,
   1.43117,
   1.448623,
   1.466077,
   1.48353,
   1.500983,
   1.518436,
   1.53589,
   1.553343,
   1.570796,
   1.58825,
   1.605703,
   1.623156,
   1.64061,
   1.658063,
   1.675516,
   1.692969,
   1.710423,
   1.727876,
   1.745329,
   1.762783,
   1.780236,
   1.797689,
   1.815142,
   1.832596,
   1.850049,
   1.867502,
   1.884956,
   1.902409,
   1.919862,
   1.937315,
   1.954769,
   1.972222,
   1.989675,
   2.007129,
   2.024582,
   2.042035,
   2.059489,
   2.076942,
   2.094395,
   2.111848,
   2.129302,
   2.146755,
   2.164208,
   2.181662,
   2.199115,
   2.216568,
   2.234021,
   2.251475,
   2.268928,
   2.286381,
   2.303835,
   2.321288,
   2.338741,
   2.356194,
   2.373648,
   2.391101,
   2.408554,
   2.426008,
   2.443461,
   2.460914,
   2.478368,
   2.495821,
   2.513274,
   2.530727,
   2.548181,
   2.565634,
   2.583087,
   2.600541,
   2.617994,
   2.635447,
   2.6529,
   2.670354,
   2.687807,
   2.70526,
   2.722714,
   2.740167,
   2.75762,
   2.775074,
   2.792527,
   2.80998,
   2.827433,
   2.844887,
   2.86234,
   2.879793,
   2.897247,
   2.9147,
   2.932153,
   2.949606,
   2.96706,
   2.984513,
   3.001966,
   3.01942,
   3.036873,
   3.054326,
   3.071779,
   3.089233,
   3.106686,
   3.124139,
   3.141593,
   3.159046,
   3.176499,
   3.193953,
   3.211406,
   3.228859,
   3.246312,
   3.263766,
   3.281219,
   3.298672,
   3.316126,
   3.333579,
   3.351032,
   3.368485,
   3.385939,
   3.403392,
   3.420845,
   3.438299,
   3.455752,
   3.473205,
   3.490659,
   3.508112,
   3.525565,
   3.543018,
   3.560472,
   3.577925,
   3.595378,
   3.612832,
   3.630285,
   3.647738,
   3.665191,
   3.682645,
   3.700098,
   3.717551,
   3.735005,
   3.752458,
   3.769911,
   3.787364,
   3.804818,
   3.822271,
   3.839724,
   3.857178,
   3.874631,
   3.892084,
   3.909538,
   3.926991,
   3.944444,
   3.961897,
   3.979351,
   3.996804,
   4.014257,
   4.031711,
   4.049164,
   4.066617,
   4.084071,
   4.101524,
   4.118977,
   4.13643,
   4.153883,
   4.171337,
   4.18879,
   4.206244,
   4.223697,
   4.24115,
   4.258604,
   4.276057,
   4.29351,
   4.310963,
   4.328416,
   4.34587,
   4.363323,
   4.380776,
   4.39823,
   4.415683,
   4.433136,
   4.45059,
   4.468043,
   4.485496,
   4.502949,
   4.520403,
   4.537856,
   4.555309,
   4.572762,
   4.590216,
   4.607669,
   4.625123,
   4.642576,
   4.660029,
   4.677483,
   4.694936,
   4.712389,
   4.729842,
   4.747295,
   4.764749,
   4.782202,
   4.799655,
   4.817109,
   4.834562,
   4.852015,
   4.869469,
   4.886922,
   4.904375,
   4.921828,
   4.939282,
   4.956735,
   4.974188,
   4.991642,
   5.009095,
   5.026548,
   5.044002,
   5.061455,
   5.078908,
   5.096362,
   5.113815,
   5.131268,
   5.148721,
   5.166174,
   5.183628,
   5.201081,
   5.218534,
   5.235988,
   5.253441,
   5.270895,
   5.288348,
   5.305801,
   5.323254,
   5.340707,
   5.358161,
   5.375614,
   5.393067,
   5.410521,
   5.427974,
   5.445427,
   5.462881,
   5.480334,
   5.497787,
   5.515241,
   5.532694,
   5.550147,
   5.5676,
   5.585053,
   5.602507,
   5.61996,
   5.637414,
   5.654867,
   5.67232,
   5.689774,
   5.707227,
   5.72468,
   5.742133,
   5.759586,
   5.77704,
   5.794493,
   5.811946,
   5.8294,
   5.846853,
   5.864306,
   5.88176,
   5.899213,
   5.916666,
   5.934119,
   5.951573,
   5.969026,
   5.986479,
   6.003932,
   6.021386,
   6.038839,
   6.056293,
   6.073746,
   6.091199,
   6.108653,
   6.126106,
   6.143559,
   6.161012,
   6.178465,
   6.195919,
   6.213372,
   6.230825,
   6.248279,
   6.265732};
   Double_t Graph0_fy2[360] = {
   7.29551e-05,
   6.68455e-05,
   6.06425e-05,
   5.42534e-05,
   4.76419e-05,
   4.08516e-05,
   3.39534e-05,
   2.69938e-05,
   1.99866e-05,
   1.29367e-05,
   5.8604e-06,
   -1.208e-06,
   -8.2262e-06,
   -1.516e-05,
   -2.1999e-05,
   -2.87512e-05,
   -3.54219e-05,
   -4.19979e-05,
   -4.8464e-05,
   -5.48352e-05,
   -6.11594e-05,
   -6.75147e-05,
   -7.39898e-05,
   -8.0632e-05,
   -8.74362e-05,
   -9.43231e-05,
   -0.000101149,
   -0.000107762,
   -0.000114065,
   -0.00012007,
   -0.000125845,
   -0.000131434,
   -0.000136856,
   -0.000142126,
   -0.000147272,
   -0.000152322,
   -0.000157282,
   -0.000162132,
   -0.000166868,
   -0.000171482,
   -0.000175932,
   -0.00018019,
   -0.000184275,
   -0.000188223,
   -0.000192062,
   -0.000195804,
   -0.000199446,
   -0.000202994,
   -0.000206459,
   -0.000209846,
   -0.000213154,
   -0.000216385,
   -0.000219553,
   -0.000222667,
   -0.000225725,
   -0.00022871,
   -0.000231603,
   -0.000234392,
   -0.000237081,
   -0.000239681,
   -0.000242209,
   -0.000244687,
   -0.00024713,
   -0.000249541,
   -0.000251899,
   -0.000254166,
   -0.000256306,
   -0.000258298,
   -0.000260132,
   -0.000261801,
   -0.000263296,
   -0.000264641,
   -0.000265892,
   -0.000267113,
   -0.000268357,
   -0.000269648,
   -0.000270993,
   -0.00027238,
   -0.000273801,
   -0.000275256,
   -0.000276742,
   -0.000278221,
   -0.000279615,
   -0.000280847,
   -0.000281872,
   -0.000282692,
   -0.000283335,
   -0.000283833,
   -0.000284205,
   -0.000284456,
   -0.000284587,
   -0.000284591,
   -0.000284467,
   -0.000284214,
   -0.000283812,
   -0.000283219,
   -0.000282394,
   -0.000281307,
   -0.000279954,
   -0.00027834,
   -0.000276485,
   -0.000274424,
   -0.000272203,
   -0.000269865,
   -0.000267447,
   -0.000264971,
   -0.000262422,
   -0.000259764,
   -0.00025695,
   -0.000253943,
   -0.000250735,
   -0.00024731,
   -0.000243645,
   -0.000239724,
   -0.000235558,
   -0.000231175,
   -0.000226604,
   -0.000221862,
   -0.000216956,
   -0.000211907,
   -0.000206749,
   -0.000201506,
   -0.000196174,
   -0.000190739,
   -0.000185183,
   -0.000179494,
   -0.000173675,
   -0.000167739,
   -0.000161687,
   -0.000155491,
   -0.000149148,
   -0.000142678,
   -0.00013613,
   -0.000129593,
   -0.000123149,
   -0.000116848,
   -0.000110714,
   -0.000104767,
   -9.90175e-05,
   -9.34551e-05,
   -8.80423e-05,
   -8.27296e-05,
   -7.74709e-05,
   -7.22374e-05,
   -6.70306e-05,
   -6.18803e-05,
   -5.68302e-05,
   -5.19202e-05,
   -4.71736e-05,
   -4.25895e-05,
   -3.81537e-05,
   -3.38604e-05,
   -2.97196e-05,
   -2.57518e-05,
   -2.19801e-05,
   -1.84268e-05,
   -1.51188e-05,
   -1.20879e-05,
   -9.3619e-06,
   -6.9535e-06,
   -4.8514e-06,
   -3.0198e-06,
   -1.4031e-06,
   6.42e-08,
   1.4484e-06,
   2.8113e-06,
   4.2092e-06,
   5.6925e-06,
   7.3039e-06,
   9.073e-06,
   1.10071e-05,
   1.30825e-05,
   1.52505e-05,
   1.74609e-05,
   1.96816e-05,
   2.1901e-05,
   2.41145e-05,
   2.631e-05,
   2.84718e-05,
   3.05992e-05,
   3.27186e-05,
   3.4883e-05,
   3.716e-05,
   3.96065e-05,
   4.22455e-05,
   4.50579e-05,
   4.79989e-05,
   5.10134e-05,
   5.40508e-05,
   5.708e-05,
   6.00914e-05,
   6.30977e-05,
   6.61254e-05,
   6.91921e-05,
   7.2283e-05,
   7.53524e-05,
   7.83442e-05,
   8.12227e-05,
   8.39666e-05,
   8.65541e-05,
   8.89635e-05,
   9.11866e-05,
   9.32382e-05,
   9.51533e-05,
   9.69812e-05,
   9.8769e-05,
   0.000100535,
   0.000102255,
   0.000103877,
   0.000105365,
   0.000106715,
   0.000107952,
   0.000109116,
   0.000110238,
   0.000111329,
   0.000112379,
   0.000113369,
   0.000114289,
   0.000115141,
   0.000115928,
   0.00011666,
   0.000117358,
   0.000118047,
   0.000118737,
   0.000119409,
   0.000120025,
   0.000120535,
   0.000120912,
   0.000121138,
   0.000121195,
   0.000121058,
   0.000120728,
   0.00012023,
   0.000119616,
   0.000118938,
   0.000118248,
   0.00011758,
   0.000116946,
   0.000116346,
   0.000115792,
   0.000115321,
   0.000115003,
   0.000114923,
   0.000115151,
   0.000115712,
   0.000116585,
   0.000117727,
   0.000119093,
   0.000120637,
   0.000122301,
   0.000124015,
   0.000125724,
   0.000127379,
   0.000128919,
   0.000130299,
   0.000131525,
   0.000132628,
   0.000133641,
   0.000134597,
   0.000135534,
   0.000136477,
   0.000137433,
   0.000138404,
   0.00013939,
   0.000140404,
   0.000141468,
   0.00014261,
   0.000143854,
   0.000145215,
   0.000146688,
   0.000148258,
   0.000149895,
   0.000151569,
   0.000153258,
   0.000154945,
   0.000156617,
   0.000158264,
   0.000159878,
   0.000161456,
   0.000163018,
   0.000164589,
   0.000166189,
   0.000167824,
   0.000169486,
   0.000171164,
   0.00017285,
   0.000174526,
   0.000176178,
   0.000177798,
   0.000179388,
   0.000180974,
   0.000182577,
   0.000184219,
   0.000185926,
   0.000187736,
   0.000189702,
   0.000191887,
   0.000194356,
   0.00019714,
   0.000200217,
   0.000203512,
   0.000206934,
   0.000210405,
   0.000213862,
   0.000217258,
   0.000220564,
   0.000223769,
   0.000226876,
   0.000229885,
   0.000232773,
   0.000235504,
   0.000238062,
   0.000240448,
   0.00024267,
   0.000244733,
   0.000246628,
   0.000248336,
   0.000249852,
   0.000251178,
   0.000252313,
   0.000253234,
   0.000253886,
   0.000254197,
   0.000254111,
   0.00025361,
   0.000252716,
   0.000251452,
   0.000249829,
   0.000247869,
   0.000245596,
   0.000243021,
   0.000240127,
   0.000236869,
   0.000233216,
   0.00022918,
   0.000224823,
   0.000220226,
   0.000215454,
   0.000210543,
   0.000205503,
   0.00020031,
   0.000194912,
   0.000189259,
   0.000183346,
   0.000177195,
   0.000170825,
   0.000164259,
   0.000157551,
   0.000150773,
   0.000143977,
   0.000137185,
   0.000130413,
   0.000123686,
   0.000117027,
   0.000110453,
   0.000103973,
   9.75945e-05,
   9.13241e-05,
   8.51543e-05,
   7.90461e-05};
   TGraph *graph = new TGraph(360,Graph0_fx2,Graph0_fy2);
   graph->SetName("Graph0");
   graph->SetTitle(";#theta [rad];#LTy#GT [mm]");
   graph->SetFillStyle(1000);
   graph->SetMarkerStyle(20);
   
   TH1F *Graph_Graph_Graph12 = new TH1F("Graph_Graph_Graph12","",360,0,6.892305);
   Graph_Graph_Graph12->SetMinimum(-0.0003384698);
   Graph_Graph_Graph12->SetMaximum(0.0003080758);
   Graph_Graph_Graph12->SetDirectory(0);
   Graph_Graph_Graph12->SetStats(0);

   Int_t ci;      // for color index setting
   TColor *color; // for color definition with alpha
   ci = TColor::GetColor("#000099");
   Graph_Graph_Graph12->SetLineColor(ci);
   Graph_Graph_Graph12->GetXaxis()->SetTitle("#theta [rad]");
   Graph_Graph_Graph12->GetXaxis()->SetRange(1,329);
   Graph_Graph_Graph12->GetXaxis()->CenterTitle(true);
   Graph_Graph_Graph12->GetXaxis()->SetLabelFont(42);
   Graph_Graph_Graph12->GetXaxis()->SetLabelSize(0.035);
   Graph_Graph_Graph12->GetXaxis()->SetTitleOffset(1.2);
   Graph_Graph_Graph12->GetXaxis()->SetTitleFont(42);
   Graph_Graph_Graph12->GetYaxis()->SetTitle("#LTy#GT [mm]");
   Graph_Graph_Graph12->GetYaxis()->CenterTitle(true);
   Graph_Graph_Graph12->GetYaxis()->SetNdivisions(4000510);
   Graph_Graph_Graph12->GetYaxis()->SetLabelFont(42);
   Graph_Graph_Graph12->GetYaxis()->SetLabelSize(0.035);
   Graph_Graph_Graph12->GetYaxis()->SetTitleOffset(1.25);
   Graph_Graph_Graph12->GetYaxis()->SetTitleFont(42);
   Graph_Graph_Graph12->GetZaxis()->SetLabelFont(42);
   Graph_Graph_Graph12->GetZaxis()->SetLabelSize(0.035);
   Graph_Graph_Graph12->GetZaxis()->SetTitleSize(0.035);
   Graph_Graph_Graph12->GetZaxis()->SetTitleFont(42);
   graph->SetHistogram(Graph_Graph_Graph12);
   
   
   TF1 *fCOD3 = new TF1("fCOD","( ([0]/0.108) +  ([1]*cos(x+[2])/(1-0.108)) + ([3]*cos(2*x+[4])/(4-0.108)) )",0,6.283185, TF1::EAddToList::kNo);
   fCOD3->SetFillColor(19);
   fCOD3->SetFillStyle(0);
   fCOD3->SetLineColor(2);
   fCOD3->SetLineWidth(2);
   fCOD3->SetChisquare(2.005126e-07);
   fCOD3->SetNDF(355);
   fCOD3->GetXaxis()->SetLabelFont(42);
   fCOD3->GetXaxis()->SetLabelSize(0.035);
   fCOD3->GetXaxis()->SetTitleSize(0.035);
   fCOD3->GetXaxis()->SetTitleFont(42);
   fCOD3->GetYaxis()->SetLabelFont(42);
   fCOD3->GetYaxis()->SetLabelSize(0.035);
   fCOD3->GetYaxis()->SetTitleSize(0.035);
   fCOD3->GetYaxis()->SetTitleOffset(0);
   fCOD3->GetYaxis()->SetTitleFont(42);
   fCOD3->SetParameter(0,2.687495e-07);
   fCOD3->SetParError(0,1.352786e-07);
   fCOD3->SetParLimits(0,0,0);
   fCOD3->SetParameter(1,0.0001850538);
   fCOD3->SetParError(1,1.581195e-06);
   fCOD3->SetParLimits(1,0,0);
   fCOD3->SetParameter(2,1.555251);
   fCOD3->SetParError(2,9.076413e-05);
   fCOD3->SetParLimits(2,-3.141593,3.141593);
   fCOD3->SetParameter(3,0.0003125653);
   fCOD3->SetParError(3,7.154871e-06);
   fCOD3->SetParLimits(3,0,0);
   fCOD3->SetParameter(4,0.6878055);
   fCOD3->SetParError(4,9.210254e-05);
   fCOD3->SetParLimits(4,-3.141593,3.141593);
   fCOD3->SetParent(graph);
   graph->GetListOfFunctions()->Add(fCOD3);
   
   TPaveStats *ptstats = new TPaveStats(0.62,0.575,0.98,0.935,"brNDC");
   ptstats->SetName("stats");
   ptstats->SetBorderSize(1);
   ptstats->SetFillColor(0);
   ptstats->SetTextAlign(12);
   ptstats->SetTextFont(42);
   TText *ptstats_LaTex = ptstats->AddText("#chi^{2} / ndf = 2.005e-07 / 355");
   ptstats_LaTex = ptstats->AddText("p0       = 2.687e-07 #pm 1.353e-07 ");
   ptstats_LaTex = ptstats->AddText("p1       = 0.0001851 #pm 1.581e-06 ");
   ptstats_LaTex = ptstats->AddText("p2       = 1.555 #pm 9.076e-05 ");
   ptstats_LaTex = ptstats->AddText("p3       = 0.0003126 #pm 7.155e-06 ");
   ptstats_LaTex = ptstats->AddText("p4       = 0.6878 #pm 9.21e-05 ");
   ptstats->SetOptStat(0);
   ptstats->SetOptFit(20222);
   ptstats->Draw();
   graph->GetListOfFunctions()->Add(ptstats);
   ptstats->SetParent(graph->GetListOfFunctions());
   graph->Draw("ap");
   c->Modified();
   c->cd();
   c->SetSelected(c);
}
